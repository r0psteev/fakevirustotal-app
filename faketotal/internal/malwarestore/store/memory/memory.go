package memory

import (
	"github.com/r0psteev/faketotal/internal/malwarestore"
)

type InMemoryStore struct {
	samples []malwarestore.MalwareSample
}

func (store *InMemoryStore) FindSample(hash string) (*malwarestore.MalwareSample, error) {
	for _, sample := range store.samples {
		if sample.Hash == hash {
			return &sample, nil
		}
	}
	return &malwarestore.MalwareSample{}, nil
}

func (store *InMemoryStore) InsertSample(sample *malwarestore.MalwareSample) error {
	store.samples = append(store.samples, *sample)
	return nil
}

func NewInMemoryStore() *InMemoryStore {
	return &InMemoryStore{
		samples: []malwarestore.MalwareSample{},
	}
}
